(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     42526,       1177]
NotebookOptionsPosition[     40585,       1112]
NotebookOutlinePosition[     41063,       1131]
CellTagsIndexPosition[     41020,       1128]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.526462839973236*^9, 3.5264628448507023`*^9}}],

Cell["1 is wait, 2 is transplant", "Text",
 CellChangeTimes->{{3.526460465281464*^9, 3.52646047018999*^9}, {
  3.526460522668758*^9, 3.526460542108487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", "=", ".95"}], ";"}]], "Input",
 CellChangeTimes->{{3.526461520417467*^9, 3.526461523087727*^9}, 
   3.526462862010303*^9, 3.526463081258452*^9, {3.526464280382009*^9, 
   3.526464304438402*^9}, 3.526464411221364*^9, {3.5264650656845284`*^9, 
   3.526465069404791*^9}, {3.526465112635448*^9, 3.526465132842822*^9}, {
   3.526465278102669*^9, 3.526465305215416*^9}, {3.526465351494854*^9, 
   3.526465367339902*^9}, 3.526635058232498*^9, {3.526636073012744*^9, 
   3.5266360899397078`*^9}}],

Cell[CellGroupData[{

Cell["Reward Functions", "Subsubtitle",
 CellChangeTimes->{{3.526460511541918*^9, 3.526460513479908*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"r", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"r", "[", 
      RowBox[{"3", ",", "2"}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "75", ",", "60"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{
    RowBox[{"h_", "/;", 
     RowBox[{"1", "\[LessEqual]", "h", "\[LessEqual]", "3"}]}], ",", "1"}], 
   "]"}], ":=", "17"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{"4", ",", "_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{"5", ",", "_"}], "]"}], ":=", "0"}]}], "Input",
 CellChangeTimes->{{3.526460439967383*^9, 3.526460586644609*^9}, {
   3.5264628263434353`*^9, 3.526462832025593*^9}, {3.5264637419015913`*^9, 
   3.526463760660677*^9}, {3.52646425677185*^9, 3.526464258578907*^9}, {
   3.526464348527705*^9, 3.526464431722682*^9}, {3.526464676896228*^9, 
   3.526464707724349*^9}, {3.526464759909319*^9, 3.526464779043602*^9}, {
   3.526464912777842*^9, 3.526464932288834*^9}, {3.526465020999017*^9, 
   3.526465031188632*^9}, {3.526465102212926*^9, 3.5264651218445683`*^9}, {
   3.526465243188162*^9, 3.5264652747046022`*^9}, {3.526465343322217*^9, 
   3.526465344008205*^9}, 3.526465479236966*^9, {3.526635344267351*^9, 
   3.526635395159493*^9}, {3.526636095750846*^9, 3.5266360958535748`*^9}, {
   3.526636247973139*^9, 3.526636248163673*^9}, {3.526636523209136*^9, 
   3.52663655082975*^9}, {3.5266366286361437`*^9, 3.526636659159814*^9}, {
   3.526637999627836*^9, 3.5266380097720203`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Probabilities", "Subsubtitle",
 CellChangeTimes->{{3.526460592917378*^9, 3.526460595339113*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"h", ",", "2"}], "]"}], "-", 
      RowBox[{"r", "[", 
       RowBox[{
        RowBox[{"h", "+", "1"}], ",", "2"}], "]"}]}], 
     RowBox[{"r", "[", 
      RowBox[{"h", ",", "2"}], "]"}]], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "1", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"\[Lambda]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"4", ",", 
         RowBox[{"h", "+", "1"}], ",", "1"}], "]"}], "-", 
       RowBox[{"P", "[", 
        RowBox[{"4", ",", "h", ",", "1"}], "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "1", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"k", "=", "j"}], "3"], 
       RowBox[{"P", "[", 
        RowBox[{"k", ",", "h", ",", "1"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"h", "+", "1"}], ",", "3"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"j", ",", "h"}], "]"}], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"k", "=", "j"}], "3"], 
        RowBox[{"P", "[", 
         RowBox[{"k", ",", 
          RowBox[{"h", "+", "1"}], ",", "1"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"h", "+", "1"}], ",", "3"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "1", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.526636957678309*^9, 3.526637099514873*^9}, {
  3.526637324213008*^9, 3.526637412558402*^9}, {3.526637498285549*^9, 
  3.52663751613216*^9}, {3.5266380830401897`*^9, 3.52663808533559*^9}}],

Cell[TextData[{
 "Probabilities ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["s", "2"], "|", 
      SubscriptBox["s", "1"]}], ",", "a"}], "]"}], TraditionalForm]]],
 " of end in state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "2"], TraditionalForm]]],
 " given we\[CloseCurlyQuote]re in state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "1"], TraditionalForm]]],
 "and take action ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.526460781448124*^9, 3.5264608466148033`*^9}, {
  3.526636382682933*^9, 3.5266363898419743`*^9}, {3.526637697773274*^9, 
  3.526637699286743*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"x_", ",", "1", ",", "1"}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "x", ",", "1", ",", ".8", ",", "2", ",", ".1", ",", "3", ",", ".05", ",", 
    "4", ",", "0.05", ",", "5", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"x_", ",", "2", ",", "1"}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "x", ",", "1", ",", ".1", ",", "2", ",", ".2", ",", "3", ",", ".4", ",", 
    "4", ",", ".3", ",", "5", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"x_", ",", "3", ",", "1"}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "x", ",", "1", ",", ".05", ",", "2", ",", ".05", ",", "3", ",", ".1", ",", 
    "4", ",", ".8", ",", "5", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"y_", ",", "x_", ",", "2"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[NotEqual]", "4"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"y", "\[Equal]", "5"}], ",", "1", ",", "0"}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"y", "\[Equal]", "4"}], ",", "1", ",", "0"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"x_", ",", "4", ",", "_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[NotEqual]", "4"}], ",", "0", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"x_", ",", "5", ",", "_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[NotEqual]", "5"}], ",", "0", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Not]", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"x", ",", "i", ",", "1"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "5"}], "}"}]}], "]"}], "-", "1"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
        "1"}], " ", "]"}], "\[Equal]", "0"}]}], "||", 
    RowBox[{"\[Not]", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"x", ",", "i", ",", "2"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "5"}], "}"}]}], "]"}], "-", "1"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], "]"}], " ", 
        ",", "1"}], "]"}], "\[Equal]", "0"}]}]}], ",", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Probabilities don't sum to one.\>\"", "]"}], 
    ";", 
    RowBox[{"EmitSound", "[", 
     RowBox[{"Sound", "[", 
      RowBox[{"SoundNote", "[", "]"}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.526460623355112*^9, 3.526460638077509*^9}, {
   3.526460670908512*^9, 3.5264607531532793`*^9}, {3.526460798785714*^9, 
   3.5264608042815247`*^9}, {3.526460850559339*^9, 3.526461052431303*^9}, {
   3.52646117956491*^9, 3.5264612535487843`*^9}, {3.526461558871192*^9, 
   3.526461816636486*^9}, {3.526461903109653*^9, 3.526461980434692*^9}, {
   3.526462039105798*^9, 3.5264621040058413`*^9}, {3.526464450768373*^9, 
   3.5264644968008957`*^9}, {3.5264645340175457`*^9, 
   3.5264645770069637`*^9}, {3.5264646280528393`*^9, 3.526464689291943*^9}, {
   3.526465260191207*^9, 3.526465261910157*^9}, {3.526465388788455*^9, 
   3.526465440969228*^9}, {3.526635100600874*^9, 3.52663511129771*^9}, {
   3.5266351460593*^9, 3.526635223943494*^9}, {3.526635684614688*^9, 
   3.526635693029935*^9}, {3.526635962672122*^9, 3.526635970895585*^9}, {
   3.526636049136458*^9, 3.5266360651928368`*^9}, {3.526636201327496*^9, 
   3.526636218262252*^9}, 3.526636384497291*^9, {3.526636453793787*^9, 
   3.526636485809401*^9}, {3.52663659113386*^9, 3.52663661832399*^9}, {
   3.5266366716508293`*^9, 3.526636681351816*^9}, {3.5266376872496557`*^9, 
   3.5266376891615*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Value Iteration", "Subsubtitle",
 CellChangeTimes->{{3.5266761967517138`*^9, 3.526676198659169*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"s_", ",", "0"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"s", ",", "0"}], "]"}], "=", "100000"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "[", 
   RowBox[{"s_", ",", 
    RowBox[{"n_", "/;", 
     RowBox[{"n", ">", "0"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"s", ",", "n"}], "]"}], "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"s", ",", "a"}], "]"}], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "5"], 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"P", "[", 
          RowBox[{"j", ",", "s", ",", "a"}], "]"}], 
         RowBox[{"v", "[", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "2"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "0", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"s", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"n_", "/;", 
    RowBox[{"n", ">", "0"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"V", "[", "n", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"s", ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.526461309624*^9, 3.526461320323421*^9}, {
   3.5264613941472607`*^9, 3.526461409537779*^9}, {3.5264628715940933`*^9, 
   3.5264628832735643`*^9}, {3.526462921835348*^9, 3.526462926873851*^9}, {
   3.52646416384521*^9, 3.526464169803479*^9}, 3.526464904363954*^9, 
   3.526464984922227*^9, {3.526636759918663*^9, 3.5266367603005333`*^9}, {
   3.5266746702330847`*^9, 3.526674670839431*^9}, 3.5266747518477907`*^9, {
   3.526676200260642*^9, 3.526676201492676*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"s", ",", "#"}], "]"}], "+", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"j", "=", "1"}], "5"], 
         RowBox[{"\[Lambda]", " ", 
          RowBox[{"P", "[", 
           RowBox[{"j", ",", "s", ",", "#"}], "]"}], 
          RowBox[{"v", "[", 
           RowBox[{"j", ",", "n"}], "]"}]}]}]}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"s", ",", "#"}], "]"}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "5"], 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"P", "[", 
            RowBox[{"j", ",", "s", ",", "#"}], "]"}], 
           RowBox[{"v", "[", 
            RowBox[{"j", ",", "n"}], "]"}]}]}]}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ActionSet", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"s", ",", "n"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.526464899348049*^9, 3.526464900709752*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"V", "[", "1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "2"}], ",", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{"V", "[", "i", "]"}], "-", 
      RowBox[{"V", "[", 
       RowBox[{"i", "-", "1"}], "]"}]}], "]"}], ">", "0.0001"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{
    RowBox[{"V", "[", "i", "]"}], ";", 
    RowBox[{"max", "=", "i"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "max", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ActionSet", "[", "max", "]"}], "\[IndentingNewLine]", 
 RowBox[{"V", "[", "max", "]"}]}], "Input",
 CellChangeTimes->{{3.5264641809848824`*^9, 3.526464203647195*^9}, {
   3.526635266489729*^9, 3.526635266714651*^9}, 3.5266362747476997`*^9, {
   3.526675205282187*^9, 3.526675218842688*^9}, {3.526675927680808*^9, 
   3.526675952113825*^9}}],

Cell[BoxData["362"], "Print",
 CellChangeTimes->{
  3.526464204056896*^9, {3.5264642450380898`*^9, 3.5264643054899406`*^9}, {
   3.526464351593351*^9, 3.526464432492758*^9}, {3.5264646719109097`*^9, 
   3.526464708390671*^9}, 3.526464781784956*^9, {3.5264649074244347`*^9, 
   3.5264649566423817`*^9}, 3.526464992172694*^9, {3.526465023420711*^9, 
   3.52646503190445*^9}, {3.5264650673055058`*^9, 3.526465070616973*^9}, {
   3.526465115263917*^9, 3.5264651337445993`*^9}, {3.526465244698902*^9, 
   3.526465306710392*^9}, {3.526465344953991*^9, 3.526465358308264*^9}, 
   3.5264654087841263`*^9, {3.5264654393408422`*^9, 3.526465442305052*^9}, 
   3.526465480499198*^9, 3.526635075227755*^9, 3.526635189413253*^9, 
   3.526635230509221*^9, 3.526635272674911*^9, {3.526635349481024*^9, 
   3.5266353964221497`*^9}, 3.5266359888628473`*^9, {3.52663605185773*^9, 
   3.526636096817029*^9}, {3.526636207446062*^9, 3.526636275465316*^9}, {
   3.5266364957672*^9, 3.526636551854176*^9}, {3.526636595198166*^9, 
   3.5266366827297077`*^9}, 3.526636761523615*^9, 3.5266380143160353`*^9, {
   3.5266381117021713`*^9, 3.526638114498556*^9}, 3.526674354124206*^9, 
   3.526674676018313*^9, 3.5266747533545513`*^9, {3.5266747921596947`*^9, 
   3.52667480188561*^9}, {3.52667520701379*^9, 3.526675219473748*^9}, 
   3.526675552585927*^9, {3.526675596680642*^9, 3.5266756072047997`*^9}, {
   3.526675907832035*^9, 3.5266759297023697`*^9}, 3.526675992940546*^9, 
   3.526676226564372*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "2", ",", "1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.526635272676836*^9, {3.5266353494840918`*^9, 3.526635396426055*^9}, 
   3.526635988865705*^9, {3.526636051860112*^9, 3.526636096819499*^9}, {
   3.526636207448367*^9, 3.526636275468246*^9}, {3.526636495769743*^9, 
   3.526636551856641*^9}, {3.526636595200439*^9, 3.526636682732561*^9}, 
   3.526636761526258*^9, 3.5266380143180103`*^9, {3.526638111704265*^9, 
   3.526638114500421*^9}, 3.526674354126974*^9, 3.5266746760206213`*^9, 
   3.526674753356983*^9, {3.5266747921635323`*^9, 3.526674801887903*^9}, {
   3.526675207016696*^9, 3.526675219476781*^9}, 3.526675552588633*^9, {
   3.5266755966834517`*^9, 3.5266756072072153`*^9}, {3.5266759078346148`*^9, 
   3.526675929704852*^9}, 3.526675993005466*^9, 3.526676226567163*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "112.39669620282615`", ",", "75.00086286949282`", ",", "60.00086286949282`",
    ",", "0.0008628694928193199`", ",", "0.0008628694928193199`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.526635272676836*^9, {3.5266353494840918`*^9, 3.526635396426055*^9}, 
   3.526635988865705*^9, {3.526636051860112*^9, 3.526636096819499*^9}, {
   3.526636207448367*^9, 3.526636275468246*^9}, {3.526636495769743*^9, 
   3.526636551856641*^9}, {3.526636595200439*^9, 3.526636682732561*^9}, 
   3.526636761526258*^9, 3.5266380143180103`*^9, {3.526638111704265*^9, 
   3.526638114500421*^9}, 3.526674354126974*^9, 3.5266746760206213`*^9, 
   3.526674753356983*^9, {3.5266747921635323`*^9, 3.526674801887903*^9}, {
   3.526675207016696*^9, 3.526675219476781*^9}, 3.526675552588633*^9, {
   3.5266755966834517`*^9, 3.5266756072072153`*^9}, {3.5266759078346148`*^9, 
   3.526675929704852*^9}, 3.526675993005466*^9, 3.526676226569356*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graph", "Subsubtitle",
 CellChangeTimes->{{3.526676191017044*^9, 3.5266761914391117`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"circ", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
  RowBox[{"Disk", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrow", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Arrow", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1"}], "}"}], "+", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}], "+", 
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], "-", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}]}], "]"}]}], ")"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h1", ",", "h2", ",", "h3"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"midpoint", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], ",", "dir_", ",", 
    "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x2", "+", "x1"}], ",", 
       RowBox[{"y2", "+", "y1"}]}], "}"}], "2"], "+", 
    RowBox[{"dir", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x2", "-", "x1"}], ",", 
           RowBox[{"y2", "-", "y1"}]}], "}"}], "]"}], "/", "\[Epsilon]"}]}], 
      "}"}]}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrowUp", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], ",", 
    RowBox[{"dir_", "/;", 
     RowBox[{
      RowBox[{"dir", "\[Equal]", 
       RowBox[{"-", "1"}]}], "||", 
      RowBox[{"dir", "\[Equal]", "1"}]}]}], ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"Arrow", "[", "\[IndentingNewLine]", 
   RowBox[{"BezierCurve", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], "+", " ", 
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], ",", "dir", ",", 
           "\[Epsilon]"}], "]"}], "-", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"midpoint", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], ",", "dir", ",", 
        "\[Epsilon]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}], "+", " ", 
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], ",", "dir", ",", 
           "\[Epsilon]"}], "]"}], "-", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trans", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"death", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"label", "[", 
   RowBox[{"text_", ",", "pos_"}], "]"}], ":=", 
  RowBox[{"Text", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{"text", ",", "Medium"}], "]"}], ",", "pos", ",", 
    RowBox[{"Background", "\[Rule]", "White"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"label2", "[", 
   RowBox[{"text_", ",", "pos_"}], "]"}], ":=", 
  RowBox[{"Text", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{"text", ",", "Medium"}], "]"}], ",", "pos"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", "index_", "]"}], ":=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"arrow", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"h1", ",", "h2", ",", "h3"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"{", 
            RowBox[{"trans", ",", "death"}], "}"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arrowUp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h1", ",", "h2"}], "}"}], ",", "1", ",", "3"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arrowUp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}], ",", "1", ",", "2"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arrowUp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}], ",", "1", ",", "3"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"arrowUp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h3", ",", "h2"}], "}"}], ",", 
         RowBox[{"-", "1"}], ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arrowUp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h3", ",", "h1"}], "}"}], ",", 
         RowBox[{"-", "1"}], ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"arrowUp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h2", ",", "h1"}], "}"}], ",", 
         RowBox[{"-", "1"}], ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
       "Orange", ",", 
       RowBox[{"circ", "[", "h1", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"circ", "[", "h2", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"circ", "[", "h3", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"circ", "[", "trans", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"circ", "[", "death", "]"}], ",", "\[IndentingNewLine]", 
       "Black", ",", "\[IndentingNewLine]", 
       RowBox[{"label2", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "index"}], "]"}], ",", "0.001"}], "]"}], ",", 
         "h1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label2", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "index"}], "]"}], ",", "0.001"}], "]"}], ",", 
         "h2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label2", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"3", ",", "index"}], "]"}], ",", "0.001"}], "]"}], ",", 
         "h3"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label2", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"4", ",", "index"}], "]"}], ",", "0.001"}], "]"}], ",", 
         "trans"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label2", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"5", ",", "index"}], "]"}], ",", "0.001"}], "]"}], ",", 
         "death"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h1", ",", "trans"}], "}"}], ",", "1", ",", "10"}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"2", ",", "2"}], "]"}], ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h2", ",", "trans"}], "}"}], ",", "1", ",", "10"}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"3", ",", "2"}], "]"}], ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h3", ",", "trans"}], "}"}], ",", "1", ",", "10"}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"0", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h1", ",", "death"}], "}"}], ",", 
           RowBox[{"-", "1"}], ",", "10"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"0", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h2", ",", "death"}], "}"}], ",", 
           RowBox[{"-", "1"}], ",", "10"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"0", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h3", ",", "death"}], "}"}], ",", 
           RowBox[{"-", "1"}], ",", "10"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"1", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h1", ",", "h2"}], "}"}], ",", "1", ",", "4"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"1", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h2", ",", "h3"}], "}"}], ",", "1", ",", "4"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"midpoint", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h1", ",", "h3"}], "}"}], ",", "1", ",", "3"}], "]"}], 
          "+", 
          RowBox[{"{", 
           RowBox[{".5", ",", 
            RowBox[{"-", ".3"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"1", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h3", ",", "h2"}], "}"}], ",", 
           RowBox[{"-", "1"}], ",", "4"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"1", ",", 
         RowBox[{"midpoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h2", ",", "h1"}], "}"}], ",", 
           RowBox[{"-", "1"}], ",", "4"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"label", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"midpoint", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h3", ",", "h1"}], "}"}], ",", 
            RowBox[{"-", "1"}], ",", "3"}], "]"}], "-", 
          RowBox[{"{", 
           RowBox[{".5", ",", 
            RowBox[{"-", ".3"}]}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "]"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.526638532183858*^9, 3.52663869936418*^9}, {
   3.526638738899171*^9, 3.526638739562954*^9}, {3.526638832938369*^9, 
   3.526638849776001*^9}, {3.5266390496552343`*^9, 3.5266393127970667`*^9}, 
   3.526639593449334*^9, {3.526639625510569*^9, 3.526639642517702*^9}, {
   3.5266396971795797`*^9, 3.526639706323135*^9}, {3.526639763280403*^9, 
   3.5266402321209993`*^9}, {3.526640296862165*^9, 3.526640450817027*^9}, {
   3.526640499356823*^9, 3.5266405236521053`*^9}, {3.5266405626099777`*^9, 
   3.5266406056447*^9}, {3.526673105696558*^9, 3.526673106108102*^9}, {
   3.526674350868616*^9, 3.526674405074692*^9}, {3.526674515540538*^9, 
   3.5266746529510813`*^9}, {3.526674729053005*^9, 3.52667477841215*^9}, {
   3.5266748242726383`*^9, 3.526675040466319*^9}, {3.52667507192449*^9, 
   3.5266751897572603`*^9}, {3.526675988860128*^9, 3.526675989993479*^9}, {
   3.5266761320561438`*^9, 3.526676160381077*^9}, {3.526676254421007*^9, 
   3.5266763418934813`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Subsubtitle",
 CellChangeTimes->{{3.526676349117126*^9, 3.526676365223359*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{"j", ",", "k", ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{3.52667636524149*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8`", "0.1`", "0.05`", "0.05`", "0"},
     {"0.1`", "0.2`", "0.4`", "0.3`", "0"},
     {"0.05`", "0.05`", "0.1`", "0.8`", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.526676226998074*^9, 3.526676365242927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"g", "[", "i", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "max", ",", "1"}], "}"}], ",", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.52667622067379*^9, 3.526676221326159*^9}, {
   3.5266762658890953`*^9, 3.526676276914551*^9}, 3.526676365223894*^9, {
   3.526676522292919*^9, 3.5266765224764223`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 362, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 0, 362, 1}}, Typeset`size$$ = {
    436., {267., 273.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$5404$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$5404$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`g[$CellContext`i$$], 
      "Specifications" :> {{$CellContext`i$$, 0, 362, 1, AnimationRepetitions -> 
         1, AnimationRunning -> False, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{489., {312., 319.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.526676217866831*^9, 3.5266762268285837`*^9}, 
   3.526676317485504*^9, {3.526676352383572*^9, 3.526676365239731*^9}, 
   3.52667652324232*^9}]
}, Open  ]],

Cell["\<\
 Expect (discounted) value of waiting in state 1\
\>", "Text",
 CellChangeTimes->{{3.526676043923148*^9, 3.526676059146185*^9}, 
   3.526676096588635*^9, 3.526676365244358*^9, {3.526676399875214*^9, 
   3.526676404235044*^9}}],

Cell[BoxData[{
 RowBox[{"r", "[", 
  RowBox[{"1", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "+", 
  RowBox[{"\[Lambda]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "5"], 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"i", ",", "1", ",", "1"}], "]"}], 
     RowBox[{"v", "[", 
      RowBox[{"i", ",", 
       RowBox[{"max", "-", "1"}]}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.526675345276232*^9, 3.526675425554256*^9}, {
   3.526675489922224*^9, 3.526675508563768*^9}, {3.526675656725573*^9, 
   3.526675656949355*^9}, {3.5266756897492847`*^9, 3.526675712837463*^9}, {
   3.526675753957011*^9, 3.526675757557136*^9}, {3.526675819548955*^9, 
   3.5266758198845778`*^9}, {3.526676035186654*^9, 3.5266760686446123`*^9}, 
   3.5266763652448597`*^9}],

Cell["\<\
Expected (discounted) value of transplanting in state 1\
\>", "Text",
 CellChangeTimes->{{3.526676073842811*^9, 3.5266761191845217`*^9}, 
   3.526676365248104*^9, {3.526676406619707*^9, 3.5266764100507517`*^9}}],

Cell[BoxData[{
 RowBox[{"r", "[", 
  RowBox[{"1", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "+", 
  RowBox[{"\[Lambda]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "5"], 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"i", ",", "1", ",", "2"}], "]"}], 
     RowBox[{"v", "[", 
      RowBox[{"i", ",", 
       RowBox[{"max", "-", "1"}]}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{3.526676365248588*^9}],

Cell["In state 1, we wait.", "Text",
 CellChangeTimes->{{3.526676105799017*^9, 3.526676116744711*^9}, 
   3.526676365252006*^9, {3.526676418091063*^9, 3.52667642219678*^9}}],

Cell["\<\
 Expect (discounted) value of waiting in state 2\
\>", "Text",
 CellChangeTimes->{{3.526676043923148*^9, 3.526676059146185*^9}, 
   3.526676096588635*^9, {3.526676365244358*^9, 3.526676416786562*^9}}],

Cell[BoxData[{
 RowBox[{"r", "[", 
  RowBox[{"2", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "+", 
  RowBox[{"\[Lambda]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "5"], 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"i", ",", "2", ",", "1"}], "]"}], 
     RowBox[{"v", "[", 
      RowBox[{"i", ",", 
       RowBox[{"max", "-", "1"}]}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.526675345276232*^9, 3.526675425554256*^9}, {
   3.526675489922224*^9, 3.526675508563768*^9}, {3.526675656725573*^9, 
   3.526675656949355*^9}, {3.5266756897492847`*^9, 3.526675712837463*^9}, {
   3.526675753957011*^9, 3.526675757557136*^9}, {3.526675819548955*^9, 
   3.5266758198845778`*^9}, {3.526676035186654*^9, 3.5266760686446123`*^9}, 
   3.5266763652448597`*^9, {3.526676435925084*^9, 3.5266764429409933`*^9}}],

Cell["\<\
Expected (discounted) value of transplanting in state 2\
\>", "Text",
 CellChangeTimes->{{3.526676073842811*^9, 3.5266761191845217`*^9}, {
  3.526676365248104*^9, 3.526676387187338*^9}, {3.52667642574191*^9, 
  3.5266764272823753`*^9}}],

Cell[BoxData[{
 RowBox[{"r", "[", 
  RowBox[{"2", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "+", 
  RowBox[{"\[Lambda]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "5"], 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"i", ",", "2", ",", "2"}], "]"}], 
     RowBox[{"v", "[", 
      RowBox[{"i", ",", 
       RowBox[{"max", "-", "1"}]}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{
  3.526676365248588*^9, {3.526676433309198*^9, 3.52667643473337*^9}}],

Cell["\<\
In state 2, we transplant. This is a control limit problem, so we transplant \
in state 3 too.\
\>", "Text",
 CellChangeTimes->{{3.526676105799017*^9, 3.526676116744711*^9}, 
   3.526676365252006*^9, {3.526676454194002*^9, 3.526676468905662*^9}}]
}, Open  ]]
},
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 141, 2, 33, "Input"],
Cell[701, 24, 156, 2, 32, "Text"],
Cell[860, 28, 535, 9, 33, "Input"],
Cell[CellGroupData[{
Cell[1420, 41, 105, 1, 32, "Subsubtitle"],
Cell[1528, 44, 1697, 38, 91, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[3262, 87, 102, 1, 32, "Subsubtitle"],
Cell[3367, 90, 2139, 67, 203, "Input"],
Cell[5509, 159, 684, 24, 34, "Text"],
Cell[6196, 185, 4374, 110, 167, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[10607, 300, 106, 1, 32, "Subsubtitle"],
Cell[10716, 303, 2136, 63, 136, "Input"],
Cell[12855, 368, 1589, 48, 94, "Input"],
Cell[CellGroupData[{
Cell[14469, 420, 992, 25, 129, "Input"],
Cell[15464, 447, 1474, 21, 70, "Print"],
Cell[16941, 470, 856, 13, 70, "Output"],
Cell[17800, 485, 960, 16, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18809, 507, 96, 1, 32, "Subsubtitle"],
Cell[18908, 510, 13594, 380, 1010, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32539, 895, 96, 1, 32, "Subsubtitle"],
Cell[CellGroupData[{
Cell[32660, 900, 357, 11, 33, "Input"],
Cell[33020, 913, 865, 23, 109, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33922, 941, 564, 11, 91, "Input"],
Cell[34489, 954, 2068, 42, 651, "Output"]
}, Open  ]],
Cell[36572, 999, 236, 5, 32, "Text"],
Cell[36811, 1006, 808, 19, 89, "Input"],
Cell[37622, 1027, 221, 4, 32, "Text"],
Cell[37846, 1033, 458, 14, 89, "Input"],
Cell[38307, 1049, 173, 2, 32, "Text"],
Cell[38483, 1053, 210, 4, 32, "Text"],
Cell[38696, 1059, 856, 19, 89, "Input"],
Cell[39555, 1080, 246, 5, 32, "Text"],
Cell[39804, 1087, 506, 15, 89, "Input"],
Cell[40313, 1104, 256, 5, 32, "Text"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
